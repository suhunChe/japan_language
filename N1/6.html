<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N1 íŒŒì´ë„ ëª¨ì˜ê³ ì‚¬</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Pretendard:wght@500;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ --- */
        .back-link {
            display: inline-block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #d97706; /* ê³¨ë“œ ìƒ‰ìƒ */
            color: #1c1917; /* ë‹¤í¬ ë°°ê²½ìƒ‰ */
            text-decoration: none;
            border-radius: 8px;
            font-family: 'Pretendard', sans-serif;
            font-weight: bold;
            transition: 0.3s;
            text-align: center;
        }
        .back-link:hover { background-color: #b45309; color: white; transform: translateY(-2px); }
        .top-bar { text-align: center; background-color: #000; padding-top: 10px; }

        /* --- ê¸°ì¡´ ìˆ˜í›ˆë‹˜ CSS ì½”ë“œ --- */
        body { background-color: #000; margin: 0; padding: 0; } /* ì „ì²´ ë‹¤í¬ ëª¨ë“œ */

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .n1-final-container {
            font-family: 'Pretendard', 'Noto Sans JP', sans-serif;
            max-width: 800px; margin: 20px auto 40px auto;
            background: #1c1917; border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            border: 1px solid #44403c; overflow: hidden;
            color: #f5f5f4; min-height: 700px; display: flex; flex-direction: column; position: relative;
            box-sizing: border-box;
        }
        .n1-final-container * { box-sizing: border-box; }
        
        /* í­ì£½ ìº”ë²„ìŠ¤ */
        #confetti-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; display: none; }
        
        .quiz-header { background: linear-gradient(90deg, #b45309, #d97706); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .q-badge { background: #000; color: #fcd34d; padding: 5px 12px; border-radius: 6px; font-weight: bold; font-size: 0.9rem; }
        .timer { font-size: 1.2rem; font-weight: 800; color: #fff; background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 8px; }

        .progress-bar-bg { width: 100%; height: 6px; background: #44403c; }
        .progress-bar { width: 0%; height: 100%; background: #fcd34d; transition: width 0.3s; }

        .quiz-body { padding: 40px 30px; flex-grow: 1; display: flex; flex-direction: column; align-items: center; overflow-y: auto; }
        
        .question-card { background: #292524; border: 1px solid #57534e; padding: 25px; border-radius: 12px; width: 100%; margin-bottom: 25px; text-align: left; }
        .q-text { font-size: 1.3rem; line-height: 1.6; color: #fff; margin-bottom: 15px; }
        .q-context { background: #0f172a; padding: 15px; border-radius: 8px; margin-bottom: 15px; font-size: 1.1rem; line-height: 1.7; color: #cbd5e1; border-left: 4px solid #fcd34d; }
        
        .options-grid { display: grid; grid-template-columns: 1fr; gap: 12px; width: 100%; }
        .option-btn { background: #44403c; border: 2px solid #57534e; color: #e7e5e4; padding: 15px; border-radius: 10px; font-size: 1.1rem; cursor: pointer; transition: all 0.2s; text-align: left; }
        .option-btn:hover { border-color: #d97706; color: #fcd34d; background: #57534e; }
        
        .result-view { display: none; flex-direction: column; align-items: center; padding: 40px 20px; text-align: center; }
        .stamp { font-size: 4rem; font-weight: 900; border: 6px solid; padding: 10px 20px; border-radius: 10px; transform: rotate(-15deg); margin-bottom: 20px; opacity: 0; transition: opacity 0.5s; }
        .stamp.pass { color: #ef4444; border-color: #ef4444; opacity: 1; }
        .stamp.fail { color: #6b7280; border-color: #6b7280; opacity: 1; }
        
        .analysis-table { width: 100%; max-width: 500px; margin: 20px 0; border-collapse: collapse; background: #292524; border-radius: 8px; overflow: hidden; }
        .analysis-table th, .analysis-table td { padding: 12px; border-bottom: 1px solid #44403c; color: #e7e5e4; text-align: center; }
        .analysis-table th { background: #44403c; font-weight: bold; }
        
        .review-section { width: 100%; text-align: left; margin-top: 30px; }
        .review-card { background: #292524; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 4px solid #ef4444; }
        .review-card.correct { border-left-color: #10b981; }
        .rc-header { font-size: 0.9rem; color: #a8a29e; margin-bottom: 5px; font-weight: bold; }
        .rc-q { font-weight: bold; margin-bottom: 5px; color: #fff; font-size: 1.1rem; line-height: 1.4; }
        .rc-exp { font-size: 0.95rem; color: #d6d3d1; margin-top: 8px; padding-top: 8px; border-top: 1px solid #44403c; line-height: 1.5; }

        .btn-start, .btn-restart { background: #d97706; color: white; border: none; padding: 15px 40px; border-radius: 8px; font-size: 1.3rem; font-weight: bold; cursor: pointer; margin-top: 20px; }
        .btn-start:hover, .btn-restart:hover { background: #b45309; }
        .start-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 40px; text-align: center; }

        @media (max-width: 500px) {
            .course-grid { grid-template-columns: 1fr; }
            .start-title { font-size: 2rem; }
            .q-text { font-size: 1.1rem; }
        }
    </style>
</head>
<body>

    <div class="top-bar">
        <a href="../index.html" class="back-link">ğŸ”™ ë©”ì¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <div class="n1-final-container">
        <canvas id="confetti-canvas"></canvas>
        
        <div id="start-screen" class="start-screen">
            <h2 style="font-size: 2.5rem; color: #fcd34d; margin-bottom: 10px;">N1 FINAL MOCK EXAM</h2>
            <p style="font-size: 1.2rem; color: #a8a29e; margin-bottom: 30px;">20ë¶„ | 20ë¬¸í•­ | í•©ê²©ì»· 60ì </p>
            <button class="btn-start" onclick="startTest()">ì‹œí—˜ ì‹œì‘ â–¶</button>
        </div>

        <div id="quiz-screen" style="display:none; flex-direction:column; height:100%;">
            <div class="quiz-header">
                <span class="q-badge" id="q-category">ì¢…í•© ëª¨ì˜ê³ ì‚¬</span>
                <span class="timer" id="timer">20:00</span>
            </div>
            <div class="progress-bar-bg"><div class="progress-bar" id="progress-bar"></div></div>
            
            <div class="quiz-body" id="quiz-body">
                </div>
        </div>

        <div id="result-view" class="result-view">
            <div class="stamp" id="result-stamp">åˆæ ¼</div>
            <div style="font-size: 1.5rem; color: #fff;">ìµœì¢… ì ìˆ˜</div>
            <div style="font-size: 4rem; font-weight: 900; color: #fcd34d; margin-bottom: 20px;" id="final-score">0ì </div>
            
            <table class="analysis-table">
                <thead><tr><th>ì˜ì—­</th><th>ì ìˆ˜</th><th>ë¹„ê³ </th></tr></thead>
                <tbody id="analysis-body"></tbody>
            </table>

            <div class="review-section" id="review-list"></div>
            <button class="btn-restart" onclick="location.reload()">â†º ë‹¤ì‹œ ë„ì „</button>
        </div>
    </div>

    <script>
    const quizData = [
        // [ë¬¸ìì–´íœ˜ 8ë¬¸ì œ]
        { cat: "ë¬¸ìì–´íœ˜", q: "å½¼ã¯æ¥µã‚ã¦<u>å·§å¦™</u>ãªæ‰‹å£ã§äººã‚’é¨™ã—ãŸã€‚", options: ["ã“ã†ã¿ã‚‡ã†", "ã”ã†ã¿ã‚‡ã†", "ã“ã†ã‚†ã†", "ã”ã†ã‚†ã†"], ans: 0, exp: "å·§å¦™(ã“ã†ã¿ã‚‡ã†): êµë¬˜í•¨. 'å·§(êµ)'ëŠ” 'ã“ã†'ë¡œ ì½ìŠµë‹ˆë‹¤." },
        { cat: "ë¬¸ìì–´íœ˜", q: "é•·å¹´ã®äº¤æ¸‰ãŒã¤ã„ã«<u>å¦¥çµ</u>ã—ãŸã€‚", options: ["ãŸã‘ã¤", "ã ã‘ã¤", "ã ãã¤", "ãŸãã¤"], ans: 1, exp: "å¦¥çµ(ã ã‘ã¤): íƒ€ê²°. í˜‘ìƒì´ ì„±ë¦½ë¨." },
        { cat: "ë¬¸ìì–´íœ˜", q: "çœŸç›¸ã‚’<u>ç©¶æ˜</u>ã™ã‚‹ã€‚", options: ["ãã‚…ã†ã‚ã„", "ãã‚ã„", "ãã‚‡ã†ã‚ã„", "ã—ã‚…ã†ã‚ã„"], ans: 0, exp: "ç©¶æ˜(ãã‚…ã†ã‚ã„): ê·œëª…. ì´ì¹˜ë¥¼ ë”°ì ¸ ë°í˜." },
        { cat: "ë¬¸ìì–´íœ˜", q: "ã“ã®æ¡ç´„ã¯<u>ç ´æ£„</u>ã•ã‚ŒãŸã€‚", options: ["ã¯ã„ã", "ã¯ã", "ã¸ã„ã", "ã²ã"], ans: 1, exp: "ç ´æ£„(ã¯ã): íŒŒê¸°. ê³„ì•½ì´ë‚˜ ì¡°ì•½ì„ ê¹¨ëœ¨ë¦¼. (íê¸°ë¬¼ì€ å»ƒæ£„/ã¯ã„ã)" },
        { cat: "ë¬¸ìì–´íœ˜", q: "ä¼šç¤¾å†å»ºã®ãŸã‚ã«<u>å¥”èµ°</u>ã™ã‚‹ã€‚", options: ["ã»ã‚“ãã†", "ã»ã†ãã†", "ã¯ã‚“ãã†", "ã¼ã‚“ãã†"], ans: 0, exp: "å¥”èµ°(ã»ã‚“ãã†): ë¶„ì£¼. ì´ë¦¬ì €ë¦¬ ë°”ì˜ê²Œ ë›°ì–´ë‹¤ë‹˜." },
        { cat: "ë¬¸ìì–´íœ˜", q: "<u>ä¸€æ¦‚</u>ã«æ‚ªã„ã¨ã¯è¨€ãˆãªã„ã€‚", options: ["ã„ã¡ãŒã„", "ã„ã£ã‹ã„", "ã„ã¡ã”ã†", "ã„ã£ã‹ã¤"], ans: 0, exp: "ä¸€æ¦‚(ã„ã¡ãŒã„)ã«: ì¼ê°œ, ì¼ë¥ ì ìœ¼ë¡œ. ì£¼ë¡œ ë¶€ì • í‘œí˜„ê³¼ í•¨ê»˜ ì“°ì„." },
        { cat: "ë¬¸ìì–´íœ˜", q: "äº‹ä»¶ã®<u>çµŒç·¯</u>ã‚’èª¬æ˜ã™ã‚‹ã€‚", options: ["ã‘ã„ã„", "ãã‚‡ã†ã„", "ã‘ã„ã©", "ã‘ã„ãˆã„"], ans: 0, exp: "çµŒç·¯(ã‘ã„ã„): ê²½ìœ„. ì¼ì´ ì§„í–‰ëœ ê³¼ì •. (=ã„ãã•ã¤)" },
        { cat: "ë¬¸ìì–´íœ˜", q: "<u>æ½”ã„</u>æ…‹åº¦ã§ç½ªã‚’èªã‚ãŸã€‚", options: ["ã„ã•ãã‚ˆã„", "ãã‚ˆã„", "ãŸã®ã‚‚ã—ã„", "ã¤ã¤ã¾ã—ã„"], ans: 0, exp: "æ½”(ã„ã•ãã‚ˆ)ã„: ë–³ë–³í•˜ë‹¤, ë¯¸ë ¨ ì—†ì´ ê¹¨ë—í•˜ë‹¤." },

        // [ë¬¸ë²• 8ë¬¸ì œ]
        { cat: "ë¬¸ë²•", q: "ã“ã‚“ãªé‡è¦ãªã“ã¨ã€ç§ã®ä¸€å­˜ã§ã¯æ±ºã‚(  )ã¾ã™ã€‚", options: ["ã‹ã­", "ã‚‰ã‚Œ", "ã–ã‚‹ã‚’ãˆ", "ã‚ˆã†ãŒã‚ã‚Š"], ans: 0, exp: "Vã¾ã™+ã‹ã­ã‚‹: ~í•˜ê¸° ì–´ë µë‹¤(ë¶ˆê°€ëŠ¥). 'ê²°ì •í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤'." },
        { cat: "ë¬¸ë²•", q: "å½¼ã¯å¤©æ‰(  )åŠªåŠ›å®¶ã§ã‚‚ã‚ã‚‹ã€‚", options: ["ã¨ã‚ã£ã¦", "ã«ã—ã¦", "ã«ã‚ã£ã¦", "ãªã‚Šã«"], ans: 1, exp: "N+ã«ã—ã¦: ~ì´ì ë™ì‹œì—. 'ì²œì¬ì´ì ë™ì‹œì— ë…¸ë ¥ê°€ë‹¤'." },
        { cat: "ë¬¸ë²•", q: "äº‹å®Ÿã‚’çŸ¥ã£ãŸ(  )ã€é»™ã£ã¦ã„ã‚‹ã‚ã‘ã«ã¯ã„ã‹ãªã„ã€‚", options: ["ãã°ã‹ã‚‰", "ä»¥ä¸Š", "æ‰‹å‰", "å§‹æœ«"], ans: 1, exp: "ï½ä»¥ä¸Š: ~í•œ ì´ìƒì—ëŠ”. ë‹¹ì—°í•œ ì˜ë¬´ë‚˜ ê²°ì˜." },
        { cat: "ë¬¸ë²•", q: "ãŠå®¢æ§˜ã®å€‹äººæƒ…å ±ã¯ã€ç†ç”±ã®(  )ã‚’å•ã‚ãšé–‹ç¤ºã—ã¾ã›ã‚“ã€‚", options: ["ã„ã‹ã‚“", "ã‹ãã‚Š", "ã†ãˆ", "ã†ã¡"], ans: 0, exp: "å¦‚ä½•(ã„ã‹ã‚“)ã‚’å•ã‚ãš: ì—¬í•˜(ì–´ë– í•¨)ë¥¼ ë¶ˆë¬¸í•˜ê³ ." },
        { cat: "ë¬¸ë²•", q: "å±±é ‚ã‹ã‚‰ã®æ™¯è‰²ã¯ã€è¨€è‘‰ã§ã¯è¨€ã„(  )ç¾ã—ã•ã ã£ãŸã€‚", options: ["å°½ãã™", "åˆ‡ã‚‹", "å°½ãã›ãªã„", "åˆ‡ã‚Œãªã„"], ans: 2, exp: "Vã¾ã™+å°½ãã›ãªã„: ë‹¤ ~í•  ìˆ˜ ì—†ë‹¤. 'ë§ë¡œ ë‹¤ í•  ìˆ˜ ì—†ëŠ” ì•„ë¦„ë‹¤ì›€'." },
        { cat: "ë¬¸ë²•", q: "æŒ‡å°è€…(  )è€…ã€å¸¸ã«æ¨¡ç¯„ã‚’ç¤ºã•ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚", options: ["ãŸã‚‹", "ã”ã¨ã", "ã‚ã", "ã¨ã‚‚"], ans: 0, exp: "N+ãŸã‚‹è€…: ~ëœ ì, ~ì˜ ì…ì¥ì— ìˆëŠ” ì‚¬ëŒ. ìê²©ì´ë‚˜ ì…ì¥ì„ ê°•ì¡°." },
        { cat: "ë¬¸ë²•", q: "ã‚ã®æ˜ ç”»ã¯ã€è¦‹ã‚‹(  )ä¾¡å€¤ãŒã‚ã‚‹ã€‚", options: ["ã«ãŸãˆã‚‹", "ã«è¶³ã‚‹", "ã«ã„ãŸã‚‹", "ã«ã‚ãŸã‚‹"], ans: 1, exp: "Vã‚‹/N+ã«è¶³ã‚‹: ~í•  ë§Œí•˜ë‹¤, ~í•  ê°€ì¹˜ê°€ ìˆë‹¤. 'ë³¼ ë§Œí•œ ê°€ì¹˜'." },
        { cat: "ë¬¸ë²•", q: "é€£çµ¡ã‚‚ãªã—ã«ä¼‘ã‚€ã¨ã¯ã€ç¤¾ä¼šäººã«ã‚ã‚‹(  )è¡Œç‚ºã ã€‚", options: ["ã¾ã˜ã", "ã¹ã‹ã‚‰ã–ã‚‹", "ã”ã¨ã", "ã‚ã„ãŸ"], ans: 0, exp: "ï½ã‚ã‚‹ã¾ã˜ã: ~ì— ìˆì–´ì„œëŠ” ì•ˆ ë . 'ì‚¬íšŒì¸ìœ¼ë¡œì„œ ìˆì„ ìˆ˜ ì—†ëŠ” í–‰ìœ„'." },

        // [ë…í•´ 4ë¬¸ì œ]
        { cat: "ë…í•´", q: "í•„ìì˜ ì£¼ì¥ìœ¼ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?", context: "í˜„ëŒ€ì¸ì€ íš¨ìœ¨ì„±ì„ ì¶”êµ¬í•˜ë©° ëŠ˜ ë°”ì˜ê²Œ ì‚´ì•„ê°„ë‹¤. ê·¸ëŸ¬ë‚˜ ì—­ì„¤ì ì´ê²Œë„, ì§„ì •í•œ ì°½ì¡°ì„±ì€ 'ë‚­ë¹„'ë¼ê³  ì—¬ê²¨ì§€ëŠ” ë©í•˜ë‹ˆ ìˆëŠ” ì‹œê°„, ì¦‰ 'ê³µë°±'ì—ì„œ íƒ„ìƒí•œë‹¤. ë‡Œê°€ ì‰´ ë•Œ ë¹„ë¡œì†Œ ì„œë¡œ ë‹¤ë¥¸ ì •ë³´ë“¤ì´ ì—°ê²°ë˜ê¸° ë•Œë¬¸ì´ë‹¤.", options: ["íš¨ìœ¨ì ì¸ ì‹œê°„ ê´€ë¦¬ê°€ ì°½ì¡°ì„±ì˜ í•µì‹¬ì´ë‹¤.", "ë°”ìœ í˜„ëŒ€ ì‚¬íšŒì—ì„œ ë©í•˜ë‹ˆ ìˆëŠ” ê²ƒì€ ë‚­ë¹„ë‹¤.", "ì˜ë„ì ì¸ íœ´ì‹ê³¼ ê³µë°±ì´ ì°½ì˜ë ¥ì„ ë‚³ëŠ”ë‹¤.", "ì •ë³´ì˜ ì—°ê²°ì„ ìœ„í•´ ëŠì„ì—†ì´ í•™ìŠµí•´ì•¼ í•œë‹¤."], ans: 2, exp: "ì§€ë¬¸ì˜ í•µì‹¬ì€ 'ì§„ì •í•œ ì°½ì¡°ì„±ì€ ê³µë°±ì—ì„œ íƒ„ìƒí•œë‹¤'ì…ë‹ˆë‹¤." },
        { cat: "ë…í•´", q: "(  )ì— ë“¤ì–´ê°ˆ ì ‘ì†ì‚¬ëŠ”?", context: "ì¼ë³¸ì˜ í¸ì˜ì ì€ ë‹¨ìˆœíˆ ë¬¼ê±´ì„ íŒŒëŠ” ê³³ì´ ì•„ë‹ˆë‹¤. ê³µê³¼ê¸ˆ ìˆ˜ë‚©, íƒë°° ë°œì†¡, ì‹¬ì§€ì–´ í–‰ì • ì„œë¥˜ ë°œê¸‰ê¹Œì§€ ê°€ëŠ¥í•˜ë‹¤. (  ), 'ì‚¬íšŒì  ì¸í”„ë¼'ë¡œì„œì˜ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.", options: ["ã™ãªã‚ã¡", "ãŸã ã—", "ã¨ã“ã‚ãŒ", "ã„ã£ã½ã†"], ans: 0, exp: "ã™ãªã‚ã¡(ì¦‰, ë‹¤ì‹œ ë§í•´): ì•ì˜ êµ¬ì²´ì  ì‚¬ë¡€ë“¤ì„ ì¢…í•©í•˜ì—¬ 'ì‚¬íšŒì  ì¸í”„ë¼'ë¼ê³  ì •ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤." },
        { cat: "ë…í•´", q: "ì´ ë¬¸ì¥ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ”?", context: "ã€Œæƒ…ã‘ã¯äººã®ãŸã‚ãªã‚‰ãšã€ë¼ëŠ” ì†ë‹´ì´ ìˆë‹¤. ë‚¨ì„ ë•ëŠ” ê²ƒì€ ê²°êµ­ ëŒê³  ëŒì•„ ë‚˜ ìì‹ ì—ê²Œë„ ì¢‹ì€ ê²°ê³¼ë¡œ ëŒì•„ì˜¨ë‹¤ëŠ” ëœ»ì´ë‹¤.", options: ["ë‚¨ì—ê²Œ ë™ì •ì„ ë² í‘¸ëŠ” ê²ƒì€ ê·¸ ì‚¬ëŒì„ ìœ„í•œ ê²Œ ì•„ë‹ˆë‹¤.", "ë‚¨ì„ ë„ìš°ë©´ ë‚˜ì¤‘ì— ë‚˜ì—ê²Œ ì´ìµì´ ëœë‹¤.", "ë‚¨ì„ ë•ëŠ” ê²ƒë³´ë‹¤ ë‚˜ ìì‹ ì„ ì±™ê²¨ì•¼ í•œë‹¤.", "ì¸ì •ì€ ë‚¨ì„ ìœ„í•´ì„œ ë² í’€ì–´ì•¼ í•œë‹¤."], ans: 1, exp: "ì´ ì†ë‹´ì€ 'ë‚¨ì„ ìœ„í•˜ëŠ” ê²ƒì´ ì•„ë‹˜(ìê¸°ë¥¼ ìœ„í•¨)'ì´ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤." },
        { cat: "ë…í•´", q: "Aì‚¬ì˜ ì „ëµì€ ë¬´ì—‡ì¸ê°€?", context: "Aì‚¬ëŠ” ì‹ ì œí’ˆ ì¶œì‹œì— ì•ì„œ, ê¸°ëŠ¥ì„ ê°„ì†Œí™”í•˜ê³  ê°€ê²©ì„ ë‚®ì¶˜ 'ë¼ì´íŠ¸ ë²„ì „'ì„ ë¨¼ì € ì‹œì¥ì— ë‚´ë†“ì•˜ë‹¤. ì´ëŠ” ì†Œë¹„ìì˜ ë°˜ì‘ì„ ë¯¸ë¦¬ ì‚´í”¼ê³ , ë³¸ ì œí’ˆì— ëŒ€í•œ ê¸°ëŒ€ê°ì„ ë†’ì´ê¸° ìœ„í•œ í¬ì„ì´ì—ˆë‹¤.", options: ["ê³ ê°€ ì „ëµìœ¼ë¡œ ë¸Œëœë“œ ì´ë¯¸ì§€ë¥¼ ë†’ì¸ë‹¤.", "ì €ë ´í•œ ì²´í—˜íŒìœ¼ë¡œ ì‹œì¥ ë°˜ì‘ì„ í…ŒìŠ¤íŠ¸í•œë‹¤.", "ëª¨ë“  ê¸°ëŠ¥ì„ íƒ‘ì¬í•˜ì—¬ ì™„ë²½í•œ ì œí’ˆì„ ë‚¸ë‹¤.", "ê¸°ì¡´ ì œí’ˆì„ ë‹¨ì¢…ì‹œí‚¤ê³  ì‹ ì œí’ˆì— ì§‘ì¤‘í•œë‹¤."], ans: 1, exp: "ê¸°ëŠ¥ì„ ê°„ì†Œí™”í•˜ê³  ê°€ê²©ì„ ë‚®ì¶˜ ë¼ì´íŠ¸ ë²„ì „ì„ ë¨¼ì € ë‚´ë†“ì•„ ë°˜ì‘ì„ ì‚´í•€ë‹¤ê³  í–ˆìŠµë‹ˆë‹¤." }
    ];

    let timerInterval;
    let timeLeft = 1200; // 20ë¶„
    let userAnswers = {};

    function startTest() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'flex';
        renderQuiz();
        startTimer();
    }

    function startTimer() {
        const timerEl = document.getElementById('timer');
        timerInterval = setInterval(() => {
            timeLeft--;
            let min = Math.floor(timeLeft / 60);
            let sec = timeLeft % 60;
            timerEl.innerText = `${String(min).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
            if(timeLeft <= 0) finishTest();
        }, 1000);
    }

    function renderQuiz() {
        const qBody = document.getElementById('quiz-body');
        qBody.innerHTML = '';
        
        quizData.forEach((data, idx) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            let contextHtml = data.context ? `<div class="q-context">${data.context}</div>` : '';
            
            card.innerHTML = `
                <div style="margin-bottom:10px;"><span class="q-badge">${data.cat}</span></div>
                ${contextHtml}
                <div class="q-text">${idx+1}. ${data.q}</div>
                <div class="options-grid" id="opts-${idx}"></div>
            `;
            qBody.appendChild(card);
            
            const optsDiv = card.querySelector(`#opts-${idx}`);
            data.options.forEach((opt, oIdx) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = `${oIdx + 1}. ${opt}`;
                btn.onclick = () => selectAnswer(idx, oIdx, btn);
                optsDiv.appendChild(btn);
            });
        });
        
        // ì œì¶œ ë²„íŠ¼
        const submitBtn = document.createElement('button');
        submitBtn.className = 'btn-start';
        submitBtn.innerText = 'ë‹µì•ˆ ì œì¶œí•˜ê¸°';
        submitBtn.onclick = finishTest;
        submitBtn.style.alignSelf = 'center';
        submitBtn.style.marginBottom = '40px';
        qBody.appendChild(submitBtn);
    }

    function selectAnswer(qIdx, oIdx, btn) {
        userAnswers[qIdx] = oIdx;
        const parent = btn.parentElement;
        Array.from(parent.children).forEach(c => {
            c.style.background = '#44403c';
            c.style.color = '#e7e5e4';
            c.style.borderColor = '#57534e';
        });
        btn.style.background = '#57534e';
        btn.style.color = '#fcd34d';
        btn.style.borderColor = '#d97706';
        
        // ì§„í–‰ë°” ì—…ë°ì´íŠ¸
        const progress = (Object.keys(userAnswers).length / quizData.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;
    }

    function finishTest() {
        clearInterval(timerInterval);
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-view').style.display = 'flex';
        
        let score = 0;
        let stats = { "ë¬¸ìì–´íœ˜":{t:0, c:0}, "ë¬¸ë²•":{t:0, c:0}, "ë…í•´":{t:0, c:0} };
        const reviewList = document.getElementById('review-list');
        
        quizData.forEach((data, i) => {
            const userPick = userAnswers[i] !== undefined ? userAnswers[i] : -1;
            const isCor = (userPick === data.ans);
            if(isCor) score++;
            
            // í†µê³„
            stats[data.cat].t++;
            if(isCor) stats[data.cat].c++;
            
            // ì˜¤ë‹µë…¸íŠ¸
            const rCard = document.createElement('div');
            rCard.className = `review-card ${isCor ? 'correct' : ''}`;
            let userAnsText = userPick === -1 ? "ë¯¸ì„ íƒ" : data.options[userPick];
            rCard.innerHTML = `
                <div class="rc-header">${data.cat} - ${isCor ? 'â­• ì •ë‹µ' : 'âŒ ì˜¤ë‹µ (ë‚´ ë‹µ: ' + userAnsText + ')'}</div>
                <div class="rc-q">${i+1}. ${data.q}</div>
                <div class="rc-exp">ì •ë‹µ: <strong>${data.options[data.ans]}</strong><br>${data.exp}</div>
            `;
            reviewList.appendChild(rCard);
        });
        
        const finalScore = score * 5; // 20ë¬¸ì œ * 5ì  = 100ì 
        document.getElementById('final-score').innerText = `${finalScore}ì `;
        
        // í•©ê²© ë„ì¥ & í­ì£½
        const stamp = document.getElementById('result-stamp');
        if(finalScore >= 60) {
            stamp.innerText = "åˆæ ¼";
            stamp.className = "stamp pass";
            playConfetti();
        } else {
            stamp.innerText = "ä¸åˆæ ¼";
            stamp.className = "stamp fail";
        }
        
        // ë¶„ì„í‘œ ì±„ìš°ê¸°
        const tbody = document.getElementById('analysis-body');
        for(let k in stats) {
            if(stats[k].t > 0) {
                tbody.innerHTML += `<tr><td>${k}</td><td>${stats[k].c} / ${stats[k].t}</td><td>${Math.round(stats[k].c/stats[k].t*100)}%</td></tr>`;
            }
        }
    }

    function playConfetti() {
        const canvas = document.getElementById('confetti-canvas');
        canvas.style.display = 'block';
        const ctx = canvas.getContext('2d');
        canvas.width = 800; canvas.height = 700;
        const particles = Array.from({length: 100}, () => ({
            x: canvas.width/2, y: canvas.height/2,
            vx: (Math.random()-0.5)*10, vy: (Math.random()-0.5)*10,
            color: ['#ef4444','#3b82f6','#10b981','#fcd34d'][Math.floor(Math.random()*4)],
            size: Math.random()*8+2
        }));
        function animate() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            particles.forEach(p => {
                p.x+=p.vx; p.y+=p.vy; p.vy+=0.1;
                ctx.fillStyle = p.color; ctx.fillRect(p.x,p.y,p.size,p.size);
            });
            requestAnimationFrame(animate);
        }
        animate();
    }
    </script>
</body>
</html>
