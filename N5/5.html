<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 ë‹¨ì–´ í€´ì¦ˆ 5 (ì¡°ì‚¬/ë¬¸ë²•)</title>
    
    <style>
        /* --- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ --- */
        .back-link {
            display: inline-block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #34495e;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            font-weight: bold;
            transition: 0.3s;
            text-align: center;
        }
        .back-link:hover { background-color: #2c3e50; transform: translateY(-2px); }
        .top-bar { text-align: center; background-color: #f4f7f6; padding-top: 10px; }

        /* --- ê¸°ì¡´ ìˆ˜í›ˆë‹˜ CSS ì½”ë“œ --- */
        /* 5. ë‹¨ì–´ í€´ì¦ˆ ì „ìš© ë˜í¼ (Part 5) */
        #jp-wordquiz-wrapper-5 {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* ì˜¤íƒ€ ìˆ˜ì •ë¨ */
            padding: 40px 20px;
            border-radius: 10px;
            margin: 0 auto 30px auto; /* ì¤‘ì•™ ì •ë ¬ */
            max-width: 800px;
            position: relative;
            
            /* ë³€ìˆ˜ ì„¤ì • */
            --max-width: 450px;
            --q-font: 60px; 
            --opt-font: 18px;
            --opt-padding: 15px;
            --hint-height: 35px;
        }

        /* ì‚¬ì´ì¦ˆë³„ í´ë˜ìŠ¤ */
        #jp-wordquiz-wrapper-5.size-small { --max-width: 350px; --q-font: 45px; --opt-font: 14px; --opt-padding: 10px; --hint-height: 30px; }
        #jp-wordquiz-wrapper-5.size-large { --max-width: 700px; --q-font: 90px; --opt-font: 24px; --opt-padding: 20px; --hint-height: 50px; }

        /* ë‚´ë¶€ ì»¨í…Œì´ë„ˆ */
        #jp-wordquiz-wrapper-5 .quiz-container {
            background-color: #34495e; padding: 30px; border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); text-align: center;
            width: 100%; max-width: var(--max-width); position: relative; transition: max-width 0.3s; box-sizing: border-box;
        }

        /* íƒ€ì´í‹€ */
        #jp-wordquiz-wrapper-5 h2.game-title { margin-top: 25px; font-size: 24px; color: #ecf0f1; border: none; margin-bottom: 5px; }
        .game-subtitle { font-size: 16px; color: #e74c3c; margin-bottom: 15px; font-weight: bold; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .size-controls, .set-controls { display: flex; gap: 5px; }
        
        .ctrl-btn { background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); color: #bdc3c7; padding: 5px 10px; font-size: 12px; cursor: pointer; border-radius: 4px; }
        .ctrl-btn:hover { background: rgba(0,0,0,0.5); color: white; }
        .ctrl-btn.active { background: #3498db; color: white; border-color: #3498db; }
        .set-btn.active { background: #e74c3c; border-color: #e74c3c; color: white; }

        /* ìƒíƒœë°” */
        .quiz-status-bar { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 16px; color: #bdc3c7; background: rgba(0,0,0,0.2); padding: 12px; border-radius: 8px; }
        .highlight { color: #f1c40f; font-weight: bold; }

        /* ë¬¸ì œ ì˜ì—­ (ë‹¨ì–´ + ìŠ¤í”¼ì»¤) */
        .question-area { display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0 5px 0; }
        .question-box { font-size: var(--q-font); font-weight: bold; min-height: calc(var(--q-font) * 1.5); color: #ecf0f1; text-shadow: 2px 2px 5px rgba(0,0,0,0.3); line-height: 1.2; }
        
        /* ìŠ¤í”¼ì»¤ ë²„íŠ¼ */
        .audio-btn { background: #ecf0f1; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.1s; color: #2c3e50; }
        .audio-btn:active { transform: scale(0.9); }
        .audio-btn:hover { background: #bdc3c7; }

        /* íŒíŠ¸ ì˜ì—­ */
        .question-yomi { font-size: calc(var(--opt-font) + 4px); color: #f39c12; margin-bottom: 20px; height: var(--hint-height); font-weight: bold; transition: opacity 0.3s; display: flex; align-items: center; justify-content: center;}

        /* ë³´ê¸° ë²„íŠ¼ ì˜ì—­ */
        .options-grid { display: flex; flex-direction: column; gap: 12px; }
        .option-btn { background-color: #ecf0f1; color: #2c3e50; border: none; padding: var(--opt-padding); font-size: var(--opt-font); border-radius: 8px; cursor: pointer; transition: all 0.1s; font-weight: bold; position: relative; }
        .option-btn:hover { background-color: #bdc3c7; transform: translateY(-2px); }
        .option-btn.correct { background-color: #2ecc71 !important; color: white; transform: scale(1.02); }
        .option-btn.wrong { background-color: #e74c3c !important; color: white; opacity: 0.6; cursor: not-allowed; }
        .disabled-area { pointer-events: none; }

        /* ê²°ê³¼ í™”ë©´ */
        #quizResultScreen_5 { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(44, 62, 80, 0.98); border-radius: 15px; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        #quizResultScreen_5 h2 { font-size: 32px; margin-bottom: 10px; color: #2ecc71; border: none;}
        .result-stat { font-size: 20px; margin: 5px 0; color: white; }
        
        .mistake-log-container { margin-top: 15px; width: 90%; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; max-height: 200px; overflow-y: auto; text-align: left; }
        .mistake-item { border-bottom: 1px solid rgba(255,255,255,0.1); padding: 8px 0; font-size: 15px; color: #bdc3c7; }
        .mistake-jp { color: #e74c3c; font-weight: bold; margin-right: 8px;}
        
        .restart-btn { margin-top: 25px; padding: 12px 30px; font-size: 18px; background-color: #e67e22; color: white; border: none; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body style="background-color: #f4f7f6; margin: 0; padding: 0;">

    <div class="top-bar">
        <a href="../index.html" class="back-link">ğŸ”™ ë©”ì¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <div id="jp-wordquiz-wrapper-5">
        <div class="quiz-container">
            
            <div class="control-panel">
                <div class="set-controls">
                    <button class="ctrl-btn set-btn active" onclick="changeSet_5(1)">Set 1</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_5(2)">Set 2</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_5(3)">Set 3</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_5(4)">Set 4</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_5(5)">Set 5</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_5('all')">ALL</button>
                </div>
                <div class="size-controls">
                    <button class="ctrl-btn size-btn" onclick="setQuizSize_5('small')">ì‘ê²Œ</button>
                    <button class="ctrl-btn size-btn active" onclick="setQuizSize_5('medium')" id="btnQuizMedium_5">ë³´í†µ</button>
                    <button class="ctrl-btn size-btn" onclick="setQuizSize_5('large')">í¬ê²Œ</button>
                </div>
            </div>

            <h2 class="game-title">ğŸ‡¯ğŸ‡µ JLPT N5 ë‹¨ì–´ì¥</h2>
            <div class="game-subtitle" id="setSubtitle_5">[ Set 1 : ì‹œì‘í•˜ê¸° ]</div>

            <div class="quiz-status-bar">
                <span>ì§„í–‰: <span id="quizProgress_5" class="highlight" style="color:#2ecc71">0 / 0</span></span>
                <span>ì ìˆ˜: <span id="quizScore_5" class="highlight">0</span></span>
            </div>

            <div class="question-area">
                <div class="question-box" id="quizQuestionText_5">???</div>
                <button class="audio-btn" onclick="speak_5()" title="ë‹¨ì–´ ë“£ê¸°">ğŸ”Š</button>
            </div>
            
            <div class="question-yomi" id="quizHintBox_5"></div>

            <div class="options-grid" id="quizOptionsArea_5"></div>

            <div id="quizResultScreen_5">
                <h2>ğŸ‰ í€´ì¦ˆ ì™„ë£Œ! ğŸ‰</h2>
                <div class="result-stat">ìµœì¢… ì ìˆ˜: <b id="finalQuizScore_5" style="color:#f1c40f">0</b></div>
                <div class="result-stat">ë§ì¶˜ ê°œìˆ˜: <b id="finalQuizProgress_5">0 / 0</b></div>
                
                <div class="mistake-log-container">
                    <div style="font-size:14px; color:#e74c3c; text-align:center; margin-bottom:5px;">â–¼ í‹€ë¦° ë¬¸ë²• ë³µìŠµ â–¼</div>
                    <div id="quizMistakeList_5"></div>
                </div>

                <button class="restart-btn" onclick="initQuizGame_5()">ë‹¤ì‹œ í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // 5íƒ„: ì¡°ì‚¬, ì§€ì‹œì–´, ë¶€ì‚¬, í•„ìˆ˜ ë¬¸ë²• (100ì„ )
        const wordQuizDB_5 = [
            // Set 1: í•„ìˆ˜ ì¡°ì‚¬ (Particles) - 20ê°œ
            { jp: 'ã¯', mean: 'ì€/ëŠ” (ì£¼ì œ)', yomi: 'wa', set: 1 }, { jp: 'ãŒ', mean: 'ì´/ê°€ (ì£¼ì–´)', yomi: 'ga', set: 1 }, { jp: 'ã‚’', mean: 'ì„/ë¥¼ (ëª©ì ê²©)', yomi: 'o', set: 1 }, { jp: 'ã‚‚', mean: 'ë„ (ì—­ì‹œ)', yomi: 'mo', set: 1 }, { jp: 'ã®', mean: 'ì˜ (ì†Œìœ )', yomi: 'no', set: 1 }, { jp: 'ã«', mean: 'ì— (ì‹œê°„/ì¥ì†Œ/ëŒ€ìƒ)', yomi: 'ni', set: 1 }, { jp: 'ã¸', mean: 'ì—/ìœ¼ë¡œ (ë°©í–¥)', yomi: 'e', set: 1 }, { jp: 'ã§', mean: 'ì—ì„œ(ì¥ì†Œ)/ìœ¼ë¡œ(ìˆ˜ë‹¨)', yomi: 'de', set: 1 }, { jp: 'ã¨', mean: 'ì™€/ê³¼ (í•¨ê»˜)', yomi: 'to', set: 1 }, { jp: 'ã‚„', mean: 'ë‘/ì´ë‚˜ (ë‚˜ì—´)', yomi: 'ya', set: 1 }, { jp: 'ã‹', mean: 'ê¹Œ? (ì˜ë¬¸)/ì´ë‚˜ (ì„ íƒ)', yomi: 'ka', set: 1 }, { jp: 'ã­', mean: 'êµ°ìš”/ë„¤ìš” (ë™ì˜)', yomi: 'ne', set: 1 }, { jp: 'ã‚ˆ', mean: 'ìš”/ì•¼ (ê°•ì¡°/ì•Œë¦¼)', yomi: 'yo', set: 1 }, { jp: 'ã‹ã‚‰', mean: 'ì—ì„œ/ë¶€í„° (ì‹œì /ì›ì¸)', yomi: 'kara', set: 1 }, { jp: 'ã¾ã§', mean: 'ê¹Œì§€ (ì¢…ì )', yomi: 'made', set: 1 }, { jp: 'ã‚ˆã‚Š', mean: 'ë³´ë‹¤ (ë¹„êµ)', yomi: 'yori', set: 1 }, { jp: 'ã ã‘', mean: 'ë§Œ/ë¿ (í•œì •)', yomi: 'dake', set: 1 }, { jp: 'ã—ã‹', mean: 'ë°–ì— (ë’¤ì— ë¶€ì •)', yomi: 'shika', set: 1 }, { jp: 'ãã‚‰ã„', mean: 'ì •ë„/ì¯¤', yomi: 'kurai', set: 1 }, { jp: 'ãªã©', mean: 'ë“±/ë”°ìœ„', yomi: 'nado', set: 1 },
            // Set 2: ì§€ì‹œì–´ (ì´/ê·¸/ì €/ì–´ëŠ) - 20ê°œ
            { jp: 'ã“ã‚Œ', mean: 'ì´ê²ƒ', yomi: 'kore', set: 2 }, { jp: 'ãã‚Œ', mean: 'ê·¸ê²ƒ', yomi: 'sore', set: 2 }, { jp: 'ã‚ã‚Œ', mean: 'ì €ê²ƒ', yomi: 'are', set: 2 }, { jp: 'ã©ã‚Œ', mean: 'ì–´ëŠ ê²ƒ', yomi: 'dore', set: 2 }, { jp: 'ã“ã®', mean: 'ì´ (ëª…ì‚¬ ìˆ˜ì‹)', yomi: 'kono', set: 2 }, { jp: 'ãã®', mean: 'ê·¸ (ëª…ì‚¬ ìˆ˜ì‹)', yomi: 'sono', set: 2 }, { jp: 'ã‚ã®', mean: 'ì € (ëª…ì‚¬ ìˆ˜ì‹)', yomi: 'ano', set: 2 }, { jp: 'ã©ã®', mean: 'ì–´ëŠ (ëª…ì‚¬ ìˆ˜ì‹)', yomi: 'dono', set: 2 }, { jp: 'ã“ã“', mean: 'ì—¬ê¸°', yomi: 'koko', set: 2 }, { jp: 'ãã“', mean: 'ê±°ê¸°', yomi: 'soko', set: 2 }, { jp: 'ã‚ãã“', mean: 'ì €ê¸°', yomi: 'asoko', set: 2 }, { jp: 'ã©ã“', mean: 'ì–´ë””', yomi: 'doko', set: 2 }, { jp: 'ã“ã¡ã‚‰', mean: 'ì´ìª½ (ì •ì¤‘)', yomi: 'kochira', set: 2 }, { jp: 'ãã¡ã‚‰', mean: 'ê·¸ìª½ (ì •ì¤‘)', yomi: 'sochira', set: 2 }, { jp: 'ã‚ã¡ã‚‰', mean: 'ì €ìª½ (ì •ì¤‘)', yomi: 'achira', set: 2 }, { jp: 'ã©ã¡ã‚‰', mean: 'ì–´ëŠ ìª½ (ì •ì¤‘)', yomi: 'dochira', set: 2 }, { jp: 'ã“ã‚“ãª', mean: 'ì´ëŸ°', yomi: 'konna', set: 2 }, { jp: 'ãã‚“ãª', mean: 'ê·¸ëŸ°', yomi: 'sonna', set: 2 }, { jp: 'ã‚ã‚“ãª', mean: 'ì €ëŸ°', yomi: 'anna', set: 2 }, { jp: 'ã©ã‚“ãª', mean: 'ì–´ë–¤', yomi: 'donna', set: 2 },
            // Set 3: ì ‘ì†ì‚¬ & í•„ìˆ˜ ë¶€ì‚¬ - 20ê°œ
            { jp: 'ãã—ã¦', mean: 'ê·¸ë¦¬ê³ ', yomi: 'soshite', set: 3 }, { jp: 'ã—ã‹ã—', mean: 'ê·¸ëŸ¬ë‚˜', yomi: 'shikashi', set: 3 }, { jp: 'ã§ã‚‚', mean: 'í•˜ì§€ë§Œ', yomi: 'demo', set: 3 }, { jp: 'ã ã‹ã‚‰', mean: 'ê·¸ë˜ì„œ', yomi: 'dakara', set: 3 }, { jp: 'ãã‚Œã‹ã‚‰', mean: 'ê·¸ë¦¬ê³  ë‚˜ì„œ', yomi: 'sorekara', set: 3 }, { jp: 'ãã‚Œã§ã¯', mean: 'ê·¸ëŸ¬ë©´/ê·¸ëŸ¼', yomi: 'soredewa', set: 3 }, { jp: 'ã¾ãŸ', mean: 'ë˜/ë‹¤ì‹œ', yomi: 'mata', set: 3 }, { jp: 'ã‚‚ã†', mean: 'ë²Œì¨/ì´ë¯¸/ë”', yomi: 'mou', set: 3 }, { jp: 'ã¾ã ', mean: 'ì•„ì§', yomi: 'mada', set: 3 }, { jp: 'ã„ã¤ã‚‚', mean: 'ì–¸ì œë‚˜/í•­ìƒ', yomi: 'itsumo', set: 3 }, { jp: 'ã‚ˆã', mean: 'ìì£¼/ì˜', yomi: 'yoku', set: 3 }, { jp: 'ã¨ãã©ã', mean: 'ê°€ë”', yomi: 'tokidoki', set: 3 }, { jp: 'ã‚ã¾ã‚Š', mean: 'ê·¸ë‹¤ì§€/ë³„ë¡œ', yomi: 'amari', set: 3 }, { jp: 'ãœã‚“ãœã‚“', mean: 'ì „í˜€', yomi: 'zenzen', set: 3 }, { jp: 'ãŸã¶ã‚“', mean: 'ì•„ë§ˆ', yomi: 'tabun', set: 3 }, { jp: 'ãã£ã¨', mean: 'ê¼­/ë°˜ë“œì‹œ', yomi: 'kitto', set: 3 }, { jp: 'ã™ã', mean: 'ê³§/ë°”ë¡œ', yomi: 'sugu', set: 3 }, { jp: 'ã ã‚“ã ã‚“', mean: 'ì ì ', yomi: 'dandan', set: 3 }, { jp: 'ã‚‚ã£ã¨', mean: 'ë” (More)', yomi: 'motto', set: 3 }, { jp: 'ãŸãã•ã‚“', mean: 'ë§ì´', yomi: 'takusan', set: 3 },
            // Set 4: ê¸°ì´ˆ ë¬¸ë²• í‘œí˜„ 1 - 20ê°œ
            { jp: 'ã§ã™', mean: 'ì…ë‹ˆë‹¤', yomi: 'desu', set: 4 }, { jp: 'ã¾ã™', mean: 'í•©ë‹ˆë‹¤', yomi: 'masu', set: 4 }, { jp: 'ã‚ã‚‹', mean: 'ìˆë‹¤ (ì‚¬ë¬¼)', yomi: 'aru', set: 4 }, { jp: 'ã„ã‚‹', mean: 'ìˆë‹¤ (ìƒë¬¼)', yomi: 'iru', set: 4 }, { jp: 'ãªã„', mean: 'ì—†ë‹¤/ì•„ë‹ˆë‹¤', yomi: 'nai', set: 4 }, { jp: 'ãªã‚‹', mean: 'ë˜ë‹¤', yomi: 'naru', set: 4 }, { jp: 'ã™ã‚‹', mean: 'í•˜ë‹¤', yomi: 'suru', set: 4 }, { jp: 'ã»ã—ã„', mean: 'ì›í•˜ë‹¤ (ê°–ê³  ì‹¶ë‹¤)', yomi: 'hoshii', set: 4 }, { jp: 'ãŸã„', mean: '~í•˜ê³  ì‹¶ë‹¤ (í¬ë§)', yomi: 'tai', set: 4 }, { jp: 'ãªãŒã‚‰', mean: '~í•˜ë©´ì„œ (ë™ì‹œë™ì‘)', yomi: 'nagara', set: 4 }, { jp: 'ãŸã‚Š', mean: '~í•˜ê±°ë‚˜', yomi: 'tari', set: 4 }, { jp: 'ã¦ãã ã•ã„', mean: '~í•´ ì£¼ì„¸ìš” (ë¶€íƒ)', yomi: 'tekudasai', set: 4 }, { jp: 'ã¦ã„ã‚‹', mean: '~í•˜ê³  ìˆë‹¤ (ì§„í–‰)', yomi: 'teiru', set: 4 }, { jp: 'ã¦ã‚‚ã„ã„', mean: '~í•´ë„ ëœë‹¤ (í—ˆê°€)', yomi: 'temoii', set: 4 }, { jp: 'ã¦ã¯ã„ã‘ãªã„', mean: '~í•´ì„œëŠ” ì•ˆ ëœë‹¤ (ê¸ˆì§€)', yomi: 'tewaikenai', set: 4 }, { jp: 'ãªã„ã§', mean: '~í•˜ì§€ ë§ê³ ', yomi: 'naide', set: 4 }, { jp: 'ã®ãŒã™ã', mean: '~í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•¨', yomi: 'nogasuki', set: 4 }, { jp: 'ã®ãŒã˜ã‚‡ã†ãš', mean: '~í•˜ëŠ” ê²ƒì„ ì˜í•¨', yomi: 'nogajouzu', set: 4 }, { jp: 'ã¾ãˆã«', mean: '~í•˜ê¸° ì „ì—', yomi: 'maeni', set: 4 }, { jp: 'ã‚ã¨ã§', mean: '~í•œ í›„ì—', yomi: 'atode', set: 4 },
            // Set 5: ì ‘ë¯¸ì‚¬ & ê¸°íƒ€ í‘œí˜„ - 20ê°œ
            { jp: 'ï½ã•ã‚“', mean: '~ì”¨/ë‹˜', yomi: 'san', set: 5 }, { jp: 'ï½ãŸã¡', mean: '~ë“¤ (ë³µìˆ˜)', yomi: 'tachi', set: 5 }, { jp: 'ï½ã˜ã‚“', mean: '~ì¸ (êµ­ì )', yomi: 'jin', set: 5 }, { jp: 'ï½ã”', mean: '~ì–´ (ì–¸ì–´)', yomi: 'go', set: 5 }, { jp: 'ï½ã‚„', mean: '~ê°€ê²Œ', yomi: 'ya', set: 5 }, { jp: 'ï½ãŒãŸ', mean: '~ë¶„ë“¤ (ì¡´ê²½)', yomi: 'gata', set: 5 }, { jp: 'ï½ã¾ãˆ', mean: '~ì „ (ì‹œê°„/ìœ„ì¹˜)', yomi: 'mae', set: 5 }, { jp: 'ï½ã‚ã¨', mean: '~í›„ (ì‹œê°„)', yomi: 'ato', set: 5 }, { jp: 'ï½ãªã‹', mean: '~ì¤‘/ì†', yomi: 'naka', set: 5 }, { jp: 'ï½ãã°', mean: '~ê³/ì˜†', yomi: 'soba', set: 5 }, { jp: 'ï½å††', mean: '~ì—” (í™”í)', yomi: 'en', set: 5 }, { jp: 'ï½å›', mean: '~íšŒ/ë²ˆ (íšŸìˆ˜)', yomi: 'kai', set: 5 }, { jp: 'ï½éš', mean: '~ì¸µ', yomi: 'kai', set: 5 }, { jp: 'ï½å€‹', mean: '~ê°œ', yomi: 'ko', set: 5 }, { jp: 'ï½å†Š', mean: '~ê¶Œ (ì±…)', yomi: 'satsu', set: 5 }, { jp: 'ï½å°', mean: '~ëŒ€ (ê¸°ê³„)', yomi: 'dai', set: 5 }, { jp: 'ï½æ¯', mean: '~ì”/ê³µê¸°', yomi: 'hai', set: 5 }, { jp: 'ï½åŒ¹', mean: '~ë§ˆë¦¬ (ë™ë¬¼)', yomi: 'hiki', set: 5 }, { jp: 'ï½æœ¬', mean: '~ìë£¨/ë³‘ (ê¸´ ê²ƒ)', yomi: 'hon', set: 5 }, { jp: 'ï½æš', mean: '~ì¥ (ì¢…ì´/í‹°ì…”ì¸ )', yomi: 'mai', set: 5 }
        ];

        let quizDeck_5 = [];
        let currentQuiz_5 = null;
        let quizScore_5 = 0;
        let quizCorrectCount_5 = 0;
        let quizTotalCount_5 = 0;
        let quizWrongAnswers_5 = []; 
        let quizStartTime_5 = 0; 
        let quizMistakeCount_5 = 0; 
        let currentSet_5 = 1;

        const quizWrapper_5 = document.getElementById('jp-wordquiz-wrapper-5');
        const qText_5 = document.getElementById('quizQuestionText_5');
        const qHint_5 = document.getElementById('quizHintBox_5');
        const qOptions_5 = document.getElementById('quizOptionsArea_5');
        const qProgress_5 = document.getElementById('quizProgress_5');
        const qScore_5 = document.getElementById('quizScore_5');
        const qResult_5 = document.getElementById('quizResultScreen_5');
        const qMistakeList_5 = document.getElementById('quizMistakeList_5');
        const qSubtitle_5 = document.getElementById('setSubtitle_5');

        function setQuizSize_5(size) {
            quizWrapper_5.classList.remove('size-small', 'size-large');
            const buttons = quizWrapper_5.querySelectorAll('.size-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (size === 'small') {
                quizWrapper_5.classList.add('size-small');
                quizWrapper_5.querySelector("button[onclick=\"setQuizSize_5('small')\"]").classList.add('active');
            } else if (size === 'large') {
                quizWrapper_5.classList.add('size-large');
                quizWrapper_5.querySelector("button[onclick=\"setQuizSize_5('large')\"]").classList.add('active');
            } else {
                document.getElementById('btnQuizMedium_5').classList.add('active');
            }
        }

        function changeSet_5(set) {
            currentSet_5 = set;
            const setBtns = quizWrapper_5.querySelectorAll('.set-btn');
            setBtns.forEach(btn => btn.classList.remove('active'));
            
            if(set === 'all') {
                setBtns[5].classList.add('active');
                qSubtitle_5.innerText = `[ ì „ì²´ ë„ì „ : ì´ ${wordQuizDB_5.length}ë‹¨ì–´ ]`;
            } else {
                setBtns[set-1].classList.add('active');
                qSubtitle_5.innerText = `[ Set ${set} : ë‹¨ì–´ ${getSetRange_5(set)} ]`;
            }
            initQuizGame_5();
        }

        function getSetRange_5(set) {
            const start = (set - 1) * 20 + 1;
            const end = set * 20;
            return `${start}~${end}`;
        }

        function shuffleQuiz_5(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function initQuizGame_5() {
            let filteredDB = [];
            if (currentSet_5 === 'all') {
                filteredDB = [...wordQuizDB_5];
            } else {
                filteredDB = wordQuizDB_5.filter(item => item.set === currentSet_5);
            }

            quizDeck_5 = shuffleQuiz_5(filteredDB); 
            quizTotalCount_5 = quizDeck_5.length; 
            quizScore_5 = 0;
            quizCorrectCount_5 = 0;
            quizWrongAnswers_5 = [];
            qScore_5.innerText = quizScore_5;
            updateQuizProgress_5();
            qResult_5.style.display = 'none';
            nextQuizQuestion_5();
        }

        function updateQuizProgress_5() {
            qProgress_5.innerText = `${quizCorrectCount_5} / ${quizTotalCount_5}`;
        }

        function nextQuizQuestion_5() {
            if (quizDeck_5.length === 0) {
                endQuizGame_5();
                return;
            }
            qOptions_5.classList.remove('disabled-area');
            quizMistakeCount_5 = 0; 
            currentQuiz_5 = quizDeck_5.pop();
            qText_5.innerText = currentQuiz_5.jp;
            qHint_5.innerText = ""; 
            const options = generateQuizOptions_5(currentQuiz_5);
            renderQuizButtons_5(options);
            quizStartTime_5 = Date.now();
        }

        function generateQuizOptions_5(correctItem) {
            const otherWords = wordQuizDB_5.filter(w => w.jp !== correctItem.jp);
            const distractors = shuffleQuiz_5(otherWords).slice(0, 4);
            const finalOptions = [...distractors, correctItem];
            return shuffleQuiz_5(finalOptions);
        }

        function renderQuizButtons_5(options) {
            qOptions_5.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.mean;
                btn.onclick = () => checkQuizAnswer_5(btn, opt);
                qOptions_5.appendChild(btn);
            });
        }

        function checkQuizAnswer_5(btn, selectedOpt) {
            if (selectedOpt.jp === currentQuiz_5.jp) {
                qOptions_5.classList.add('disabled-area'); 
                btn.classList.add('correct');
                
                if (quizMistakeCount_5 === 0) {
                    const endTime = Date.now();
                    const timeTaken = (endTime - quizStartTime_5) / 1000; 
                    const point = Math.max(20, Math.floor(100 - (timeTaken * 5))); 
                    quizScore_5 += point;
                    quizCorrectCount_5++; 
                } else {
                    quizCorrectCount_5++; 
                }

                qScore_5.innerText = quizScore_5;
                updateQuizProgress_5(); 
                setTimeout(nextQuizQuestion_5, 500); 
            } else {
                btn.classList.add('wrong');
                btn.disabled = true; 
                
                if (quizMistakeCount_5 === 0) {
                    quizMistakeCount_5++;
                    qHint_5.innerText = `ğŸ’¡ íŒíŠ¸: ${currentQuiz_5.yomi}`;
                    if (!quizWrongAnswers_5.some(w => w.jp === currentQuiz_5.jp)) {
                        quizWrongAnswers_5.push(currentQuiz_5);
                    }
                } else {
                    qOptions_5.classList.add('disabled-area'); 
                    const allBtns = qOptions_5.querySelectorAll('.option-btn');
                    allBtns.forEach(b => {
                        if (b.innerText === currentQuiz_5.mean) b.classList.add('correct');
                    });
                    setTimeout(nextQuizQuestion_5, 1500);
                }
            }
        }

        function endQuizGame_5() {
            document.getElementById('finalQuizScore_5').innerText = quizScore_5;
            document.getElementById('finalQuizProgress_5').innerText = `${quizCorrectCount_5} / ${quizTotalCount_5}`;
            qMistakeList_5.innerHTML = '';
            if (quizWrongAnswers_5.length === 0) {
                qMistakeList_5.innerHTML = '<div style="color:#2ecc71; text-align:center; padding:20px;">ğŸ† ì™„ë²½í•©ë‹ˆë‹¤!</div>';
            } else {
                quizWrongAnswers_5.forEach(w => {
                    const item = document.createElement('div');
                    item.className = 'mistake-item';
                    item.innerHTML = `<span class="mistake-jp">${w.jp}</span> (${w.yomi}) : ${w.mean}`;
                    qMistakeList_5.appendChild(item);
                });
            }
            qResult_5.style.display = 'flex';
        }

        function speak_5() {
            if (!('speechSynthesis' in window)) {
                alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }
            const text = currentQuiz_5.jp;
            const utt = new SpeechSynthesisUtterance(text);
            utt.lang = 'ja-JP';
            utt.rate = 0.9; 

            const voices = window.speechSynthesis.getVoices();
            const jaVoice = voices.find(v => v.lang.includes('ja') || v.lang.includes('JP'));
            if (jaVoice) utt.voice = jaVoice;

            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utt);
        }

        if ('speechSynthesis' in window) {
            window.speechSynthesis.onvoiceschanged = function() { 
                window.speechSynthesis.getVoices(); 
            };
        }

        initQuizGame_5();
    </script>
</body>
</html>
